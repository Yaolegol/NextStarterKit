{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nimport { SHOP_ACTION_TYPES } from \"modules/Shop/constants\";\nimport { selectCurrentPage, selectProductsFilters, selectProductsSort } from \"modules/Shop/selectors\";\nimport { getProducts } from \"modules/Shop/service\";\nvar GET_PRODUCTS_FAIL = SHOP_ACTION_TYPES.GET_PRODUCTS_FAIL,\n    GET_PRODUCTS_START = SHOP_ACTION_TYPES.GET_PRODUCTS_START,\n    GET_PRODUCTS_SUCCESS = SHOP_ACTION_TYPES.GET_PRODUCTS_SUCCESS,\n    RESET_PAGE = SHOP_ACTION_TYPES.RESET_PAGE,\n    RESET_PRODUCTS_FILTERS = SHOP_ACTION_TYPES.RESET_PRODUCTS_FILTERS,\n    RESET_PRODUCTS_SORTS = SHOP_ACTION_TYPES.RESET_PRODUCTS_SORTS,\n    SET_PAGE = SHOP_ACTION_TYPES.SET_PAGE,\n    SET_PRODUCTS_FILTER = SHOP_ACTION_TYPES.SET_PRODUCTS_FILTER,\n    SET_PRODUCTS_SORT = SHOP_ACTION_TYPES.SET_PRODUCTS_SORT;\n\nvar actionGetProductsFail = function actionGetProductsFail(errors) {\n  return function (dispatch) {\n    dispatch({\n      data: errors,\n      type: GET_PRODUCTS_FAIL\n    });\n  };\n};\n\nvar actionGetProductsStart = function actionGetProductsStart() {\n  return function (dispatch) {\n    dispatch({\n      type: GET_PRODUCTS_START\n    });\n  };\n};\n\nvar actionGetProductsSuccess = function actionGetProductsSuccess(data) {\n  return function (dispatch) {\n    dispatch({\n      data: data,\n      type: GET_PRODUCTS_SUCCESS\n    });\n  };\n};\n\nexport var actionGetProducts = function actionGetProducts() {\n  return /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch, getState) {\n      var state, filters, page, sort, _yield$getProducts, data, errors, _data;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              dispatch(actionGetProductsStart());\n              _context.prev = 1;\n              state = getState();\n              filters = selectProductsFilters(state);\n              page = selectCurrentPage(state);\n              sort = selectProductsSort(state);\n              _context.next = 8;\n              return getProducts({\n                filters: filters,\n                page: page,\n                sort: sort\n              });\n\n            case 8:\n              _yield$getProducts = _context.sent;\n              data = _yield$getProducts.data;\n              errors = _yield$getProducts.errors;\n\n              if (!errors) {\n                if (page > 1) {\n                  _data = _objectSpread({\n                    isAdditional: true\n                  }, data);\n                  dispatch(actionGetProductsSuccess(_data));\n                } else {\n                  dispatch(actionGetProductsSuccess(data));\n                }\n              } else {\n                dispatch(actionGetProductsFail(errors));\n              }\n\n              _context.next = 17;\n              break;\n\n            case 14:\n              _context.prev = 14;\n              _context.t0 = _context[\"catch\"](1);\n              dispatch(actionGetProductsFail([_context.t0]));\n\n            case 17:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[1, 14]]);\n    }));\n\n    return function (_x, _x2) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n};\nexport var actionResetPage = function actionResetPage() {\n  return function (dispatch) {\n    dispatch({\n      type: RESET_PAGE\n    });\n  };\n};\nexport var actionResetProductsFilters = function actionResetProductsFilters() {\n  return function (dispatch) {\n    dispatch({\n      type: RESET_PRODUCTS_FILTERS\n    });\n  };\n};\nexport var actionResetProductsSorts = function actionResetProductsSorts() {\n  return function (dispatch) {\n    dispatch({\n      type: RESET_PRODUCTS_SORTS\n    });\n  };\n};\nexport var actionSetPage = function actionSetPage(data) {\n  return function (dispatch) {\n    dispatch({\n      data: data,\n      type: SET_PAGE\n    });\n  };\n};\nexport var actionSetProductsFilter = function actionSetProductsFilter(data) {\n  return function (dispatch) {\n    dispatch(actionResetPage());\n    dispatch({\n      data: data,\n      type: SET_PRODUCTS_FILTER\n    });\n  };\n};\nexport var actionSetProductsSort = function actionSetProductsSort(data) {\n  return function (dispatch) {\n    dispatch(actionResetPage());\n    dispatch({\n      data: data,\n      type: SET_PRODUCTS_SORT\n    });\n  };\n};","map":null,"metadata":{},"sourceType":"module"}