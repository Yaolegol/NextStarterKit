{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport { CustomIntl } from \"app/components/CustomIntl\";\nimport { Button } from \"common/components/Button\";\nimport { SortSelect } from \"common/components/CustomSelect/SortSelect\";\nimport { Layout } from \"common/components/Layout\";\nimport { selectCartProductsItems } from \"modules/Cart/selectors\";\nimport { actionGetProducts, actionResetPage, actionResetProductsFilters, actionResetProductsSorts, actionSetPage, actionSetProductsSort } from \"modules/Shop/actions\";\nimport { Filters } from \"modules/Shop/components/Filters\";\nimport { ProductCard } from \"modules/Shop/components/ProductCard\";\nimport { selectCurrentPage, selectProducts } from \"modules/Shop/selectors\";\nimport React, { useCallback, useEffect, useMemo, useState } from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport { connect } from \"react-redux\";\nimport \"styles/index.less\";\nimport \"./index.less\";\n\nvar ShopPage = function ShopPage(_ref) {\n  var cartProducts = _ref.cartProducts,\n      currentPage = _ref.currentPage,\n      dispatch = _ref.dispatch,\n      products = _ref.products;\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      sortSelectValue = _useState2[0],\n      setSortSelectValue = _useState2[1];\n\n  var handleSortSelectChange = useCallback(function (value) {\n    setSortSelectValue(value);\n    dispatch(actionSetProductsSort(_defineProperty({}, value.id, value.value)));\n    dispatch(actionGetProducts());\n  }, [dispatch]);\n  var loadMoreProducts = useCallback(function () {\n    dispatch(actionSetPage(currentPage + 1));\n    dispatch(actionGetProducts());\n  }, [currentPage, dispatch]);\n  var productCards = useMemo(function () {\n    return products.list.map(function (_ref2) {\n      var description = _ref2.description,\n          _id = _ref2._id,\n          images = _ref2.images,\n          price = _ref2.price,\n          title = _ref2.title;\n      var initialCount = cartProducts[_id] ? cartProducts[_id].count : 0;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"shop-page__product-container\",\n        key: _id\n      }, /*#__PURE__*/React.createElement(ProductCard, {\n        description: description,\n        id: _id,\n        imageUrl: images[0],\n        initialCount: initialCount,\n        price: price,\n        title: title\n      }));\n    });\n  }, [cartProducts, products]);\n  var showMore = useMemo(function () {\n    var isShow = products.list.length < products.count;\n    return isShow ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"shop-page__show-more-container\"\n    }, /*#__PURE__*/React.createElement(Button, {\n      onClick: loadMoreProducts,\n      theme: \"white\"\n    }, /*#__PURE__*/React.createElement(FormattedMessage, {\n      id: \"common.showMore\"\n    }))) : null;\n  }, [loadMoreProducts, products.count, products.list.length]);\n  useEffect(function () {\n    dispatch(actionResetPage());\n    dispatch(actionResetProductsFilters());\n    dispatch(actionResetProductsSorts());\n    dispatch(actionGetProducts());\n  }, [dispatch]);\n  return /*#__PURE__*/React.createElement(CustomIntl, null, /*#__PURE__*/React.createElement(Layout, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"shop-page\"\n  }, /*#__PURE__*/React.createElement(\"h1\", null, /*#__PURE__*/React.createElement(FormattedMessage, {\n    id: \"shop.title\"\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"shop-page__content\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"shop-page__filters-section\"\n  }, /*#__PURE__*/React.createElement(Filters, null)), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"shop-page__goods-section\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"shop-page__sort-container\"\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"shop-page__sort-select\"\n  }, /*#__PURE__*/React.createElement(SortSelect, {\n    onChange: handleSortSelectChange,\n    value: sortSelectValue\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"shop-page__goods-container\"\n  }, productCards), showMore)))));\n};\n\nexport default connect(function (state) {\n  return {\n    cartProducts: selectCartProductsItems(state),\n    currentPage: selectCurrentPage(state),\n    products: selectProducts(state)\n  };\n})(ShopPage);","map":null,"metadata":{},"sourceType":"module"}