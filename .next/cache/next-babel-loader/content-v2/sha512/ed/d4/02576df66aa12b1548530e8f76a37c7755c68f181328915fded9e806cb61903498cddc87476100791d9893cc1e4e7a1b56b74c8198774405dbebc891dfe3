{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nimport { logError } from \"common/helpers/errors\";\nvar requestHost = \"\";\n\nif (false) {\n  requestHost = \"http://localhost:8000\";\n}\n\nexport var request = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref2) {\n    var formData, isPrivate, _ref2$options, options, _ref2$toJSON, toJSON, url, headers, _options, token, fd, response;\n\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            formData = _ref2.formData, isPrivate = _ref2.isPrivate, _ref2$options = _ref2.options, options = _ref2$options === void 0 ? {} : _ref2$options, _ref2$toJSON = _ref2.toJSON, toJSON = _ref2$toJSON === void 0 ? true : _ref2$toJSON, url = _ref2.url;\n            headers = {};\n            _options = _objectSpread({}, options);\n\n            if (options.headers) {\n              headers = _objectSpread({}, options.headers);\n            }\n\n            if (!isPrivate) {\n              _context.next = 10;\n              break;\n            }\n\n            token = localStorage.getItem(\"token\");\n\n            if (token) {\n              _context.next = 9;\n              break;\n            }\n\n            console.info(\"---Token not found\");\n            return _context.abrupt(\"return\");\n\n          case 9:\n            headers = _objectSpread(_objectSpread({}, headers), {}, {\n              Authorization: \"Bearer \".concat(token)\n            });\n\n          case 10:\n            fd = new FormData();\n\n            if (formData) {\n              Object.keys(formData).forEach(function (name) {\n                var value = formData[name];\n\n                if (value instanceof FileList) {\n                  _toConsumableArray(value).forEach(function (file) {\n                    fd.append(file.name, file, file.name);\n                  });\n                } else {\n                  fd.append(name, value);\n                }\n              });\n              _options = _objectSpread(_objectSpread({}, _options), {}, {\n                body: fd\n              });\n            }\n\n            _context.prev = 12;\n            _context.next = 15;\n            return fetch(\"\".concat(requestHost).concat(url), _objectSpread(_objectSpread({}, _options), {}, {\n              headers: _objectSpread({}, headers)\n            }));\n\n          case 15:\n            response = _context.sent;\n            _context.next = 18;\n            return handleResponse({\n              response: response,\n              toJSON: toJSON\n            });\n\n          case 18:\n            return _context.abrupt(\"return\", _context.sent);\n\n          case 21:\n            _context.prev = 21;\n            _context.t0 = _context[\"catch\"](12);\n            logError(_context.t0, \"request\");\n\n          case 24:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[12, 21]]);\n  }));\n\n  return function request(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar handleResponse = /*#__PURE__*/function () {\n  var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(_ref4) {\n    var response, toJSON, status, _yield$response$json, data, errors;\n\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            response = _ref4.response, toJSON = _ref4.toJSON;\n\n            if (!toJSON) {\n              _context2.next = 15;\n              break;\n            }\n\n            _context2.prev = 2;\n            status = response.status;\n            _context2.next = 6;\n            return response.json();\n\n          case 6:\n            _yield$response$json = _context2.sent;\n            data = _yield$response$json.data;\n            errors = _yield$response$json.errors;\n            return _context2.abrupt(\"return\", {\n              data: data,\n              errors: errors,\n              status: status\n            });\n\n          case 12:\n            _context2.prev = 12;\n            _context2.t0 = _context2[\"catch\"](2);\n            logError(_context2.t0, \"handleResponse\");\n\n          case 15:\n            return _context2.abrupt(\"return\", {\n              response: response\n            });\n\n          case 16:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, null, [[2, 12]]);\n  }));\n\n  return function handleResponse(_x2) {\n    return _ref3.apply(this, arguments);\n  };\n}();","map":null,"metadata":{},"sourceType":"module"}